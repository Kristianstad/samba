#!/bin/sh
set -e
echo $SUDO_USER
if [ -n "$2" ]
then
   file="$2"
   rec="-R"
   chmod="u=rwX,go="
else
   file="$1"
   rec=""
   chmod="u=rwX,go=X"
fi
file="$(echo -n "$file" | /usr/bin/tr -dc '[:alnum:]_/')"
if [ -e "$file" ]
then
echo $file
   fileowner="`stat -c '%U' $file`"
   if [ "$fileowner" == "$SUDO_USER" ]
   then
      /bin/chown $rec root "$file"
   fi
   if [ "$fileowner" == "root" ] || [ "$fileowner" == "$SUDO_USER" ]
   then
      /bin/chmod $chmod "$file"
   fi
fi
exit 0
